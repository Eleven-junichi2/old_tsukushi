#:kivy 1.10.1
#:import get_color_from_hex kivy.utils.get_color_from_hex

<TextInput>:
    background_normal: "images/code_input.png"
    background_active: "images/code_input.png"


<Button>:
    background_normal: "images/button.png"
    background_down: "images/button_pressed.png"

<IconButton>:
    icon: ""
    StackLayout:
        pos: self.parent.pos
        size: self.parent.size
        orientation: 'lr-tb'
        Image:
            source: root.icon


<ActionBar>:
    background_image: "images/action_bar.png"


<BlockCodeBase>:
    background_color: get_color_from_hex("#FFFFFF")
    border_color: get_color_from_hex("#607D8B")
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
        Color:
            rgba: root.border_color
        Line:
            width: 2
            rectangle: self.x, self.y, self.width, self.height


<BlockFunction>:
    function_name: function_name
    argments: argments
    background_color: get_color_from_hex("#64ED95")
    height: argments.height + function_name.height
    size_hint_y: None
    orientation: "vertical"
    BoxLayout:
        orientation: "horizontal"
        Label:
            id: function_name
            size_hint_y: None
            height: self.font_size * 2
        Button:
            text: "x"
            width: 25
            size_hint_x: None
            on_release: root.parent.remove_widget(root)
    TextInput:
        id: argments
        hint_text: "(argments)"
        size_hint_y: None
        height: self.font_size * 2
        multiline: False


<BlockVariable>:
    variable_name: variable_name.text
    value: value.text
    background_color: get_color_from_hex("#FFFFFF")
    border_color: get_color_from_hex("#607D8B")
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
        Color:
            rgba: root.border_color
        Line:
            width: 2
            rectangle: self.x, self.y, self.width, self.height
    height: variable_name.height + value.height
    size_hint_y: None
    orientation: "vertical"
    BoxLayout:
        orientation: "horizontal"
        TextInput:
            id: variable_name
            hint_text: "variable name"
            size_hint_y: None
            height: self.font_size * 2
            multiline: False
        Button:
            text: "x"
            width: 25
            size_hint_x: None
            on_release: root.parent.remove_widget(root)
    TextInput:
        id: value
        hint_text: "value"
        size_hint_y: None
        height: self.font_size * 2
        multiline: False

<BlockScript>:
    background_color: get_color_from_hex("#64ED95")
    border_color: get_color_from_hex("#607D8B")
    script_name: script_name_input.text
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
        Color:
            rgba: root.border_color
        Line:
            width: 2
            rectangle: self.x, self.y, self.width, self.height
    drag_rectangle: self.x, self.y, self.width, self.height
    drag_timeout: 10000000
    drag_distance: 0
    orientation: "vertical"
    size_hint_x: 0.2
    height: self.minimum_height
    size_hint_y: None
    BoxLayout:
        orientation: "horizontal"
        Button:
            text: "run"
            height: 25
            size_hint_y: None
            on_release: root.run_script()
        Button:
            text: "x"
            size: 25, 25
            size_hint: None, None
            on_release: root.parent.remove_widget(root)
    TextInput:
        id: script_name_input
        hint_text: "script name"
        font_size: 16
        size_hint_y: None
        height: self.font_size * 2
    Button:
        height: 25
        size_hint_y: None
        id: add_button
        text: "+"
        on_release: root.add_block(app.screen_manager.get_screen("edit").block_choose_area.block_chooser)


<BlockCodeArea@RelativeLayout>:
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            size: self.size
            # pos: self.pos
            source: "images/code_input.png"
    orientation: "vertical"
    BlockScript:


<SpinnerOption>:
    height: 30
    size_hint_y: None


<BlockChooseArea@RelativeLayout>:
    block_chooser: block_chooser
    width: 150
    size_hint_x: None
    canvas.before:
        Color:
            rgba: get_color_from_hex("#D1D1D1")
        Rectangle:
            size: self.size
        Color:
            rgba: get_color_from_hex("#607D8B")
        Line:
            width: 1
            rectangle: self.x, self.y, self.width, self.height
    AnchorLayout:
        anchor_y: "top"
        Spinner:
            id: block_chooser
            values: "print", "variable", "Other", "Custom"
            text: self.values[0]
            size_hint_y: None
            height: 40

<WelcomeScreen>:
    canvas.before:
        Color:
            rgba: get_color_from_hex("#464646")
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        orientation: "vertical"
        padding: 10, 10
        spacing: 10
        ActionBar:
            height: 40
            size_hint_y: None
        BoxLayout:
            orientation: "vertical"
            padding: 148, 48, 148, 118
            spacing: 40
            Image:
                source: "images/logo.png"
                height: 32
                size_hint_y: None
            BoxLayout:
                orientation: "horizontal"
                spacing: 30
                IconButton:
                    icon: "images/open-file_icon.png"
                IconButton:
                    icon: "images/new-file_icon.png"
                    on_release: root.manager.current = "edit"
                IconButton:
                    icon: "images/explore_icon.png"
        ActionBar:
            height: 40
            size_hint_y: None


<EditScreen>:
    block_code_area: block_code_area
    block_choose_area: block_choose_area
    canvas.before:
        Color:
            rgba: get_color_from_hex("#464646")
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        orientation: "vertical"
        padding: 10, 10
        spacing: 10
        ActionBar:
            height: 40
            size_hint_y: None
            ActionView:
                ActionPrevious:
                    app_icon: ""
                    on_release: root.manager.current = "welcome"
                    ActionButton:
                        icon: "images/open-file_icon.png"
                        width: 40
                    ActionButton:
                        icon: "images/save-file_icon.png"
                        width: 40
                    ActionButton:
                        icon: "images/new-file_icon.png"
                        width: 40
        BoxLayout:
            orientation: "horizontal"
            BlockCodeArea:
                id: block_code_area
            BlockChooseArea:
                id: block_choose_area
        BoxLayout:
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
                    source: "images/action_bar.png"
            orientation: "horizontal"
            height: 40
            size_hint_y: None
            Button:
                text: "Add script"
                on_release: root.add_script()
