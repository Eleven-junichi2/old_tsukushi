#:kivy 1.10.1
#:import get_color_from_hex kivy.utils.get_color_from_hex
#:import Path pathlib.Path

<Label>:
    font_name: "NotoSansCJKjp"


<TextInput>:
    font_name: "NotoSansCJKjp"
    background_normal: "images/code_input.png"
    background_active: "images/code_input.png"


<Button>:
    background_normal: "images/button.png"
    background_down: "images/button_pressed.png"


<IconButton>:
    icon: ""
    StackLayout:
        pos: self.parent.pos
        size: self.parent.size
        orientation: 'lr-tb'
        Image:
            source: root.icon


<ActionBar>:
    background_image: "images/action_bar.png"


<EditPanelHeader>:
    text: ""
    BoxLayout:
        pos: self.parent.pos
        size: self.parent.size
        padding: dp(2)
        Label:
            text: root.text
        BoxLayout:
            AnchorLayout:
                anchor_x: "right"
                Button:
                    id: close_tab_button
                    text: "x"
                    size_hint: None, None
                    width: self.texture_size[1]
                    height: self.texture_size[1]
                    on_release:
                        root.parent.remove_widget(root)
                        root.content.clear_widgets()


<EditPanel>:
    CodeInput:


<EditArea>:
    panels: panels
    do_default_tab: False
    FloatLayout:
        id: panels
    BoxLayout:
        id: panel_headers
        orientation: "horizontal"


<Editor@BoxLayout>:
    orientation: "horizontal"
    BoxLayout:
        orientation: "vertical"
        FileChooserListView:
            id: file_chooser
            path: str(Path.home())
            # on_: print(f"touch, {self.selection}")
        BoxLayout:
            orientation: "vertical"
            size_hint_y: None
            height: self.minimum_height
            TextInput:
                text: file_chooser.path
                multiline: False
                size_hint_y: None
                height: self.minimum_height
            Button:
                text: "Open"
                size_hint_y: None
                height: self.texture_size[1]
                on_release: edit_area.add_panel()
    # Splitter:
    EditArea:
        id: edit_area


<WelcomeScreen>:
    canvas.before:
        Color:
            rgba: get_color_from_hex("#464646")
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        orientation: "vertical"
        padding: 10, 10
        spacing: 10
        ActionBar:
            height: 40
            size_hint_y: None
        BoxLayout:
            orientation: "vertical"
            padding: 148, 48, 148, 118
            spacing: 40
            Image:
                source: "images/logo.png"
                height: 32
                size_hint_y: None
            BoxLayout:
                orientation: "horizontal"
                spacing: 30
                IconButton:
                    icon: "images/open-file_icon.png"
                IconButton:
                    icon: "images/new-file_icon.png"
                    on_release: root.manager.current = "edit"
                IconButton:
                    icon: "images/explore_icon.png"
        ActionBar:
            height: 40
            size_hint_y: None


<EditScreen>:
    # code_input: code_input
    canvas.before:
        Color:
            rgba: get_color_from_hex("#464646")
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        orientation: "vertical"
        padding: 10, 10
        spacing: 10
        ActionBar:
            height: 40
            size_hint_y: None
            ActionView:
                ActionPrevious:
                    app_icon: ""
                    on_release: root.manager.current = "welcome"
                    ActionButton:
                        icon: "images/open-file_icon.png"
                        width: 40
                    ActionButton:
                        icon: "images/save-file_icon.png"
                        width: 40
                    ActionButton:
                        icon: "images/new-file_icon.png"
                        width: 40
        Editor:
        BoxLayout:
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
                    source: "images/action_bar.png"
            orientation: "horizontal"
            height: 40
            size_hint_y: None
            Button:
                text: "Run script"
