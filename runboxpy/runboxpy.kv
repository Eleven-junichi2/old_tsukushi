#:kivy 1.10.1
#:import get_color_from_hex kivy.utils.get_color_from_hex

<TextInput>:
    background_normal: "images/code_input.png"
    background_active: "images/code_input.png"


<Button>:
    background_normal: "images/button.png"
    background_down: "images/button_pressed.png"

<IconButton>:
    icon: ""
    StackLayout:
        pos: self.parent.pos
        size: self.parent.size
        orientation: 'lr-tb'
        Image:
            source: root.icon


<ActionBar>:
    background_image: "images/action_bar.png"


<BlockCode>:
    background_color: get_color_from_hex("#6495ED")
    border_color: get_color_from_hex("#607D8B")
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
        Color:
            rgba: root.border_color
        Line:
            width: 2
            rectangle: self.x, self.y, self.width, self.height


<BlockScript>:
    background_color: get_color_from_hex("#64ED95")
    border_color: get_color_from_hex("#607D8B")
    script_name: script_name_input.text
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
        Color:
            rgba: root.border_color
        Line:
            width: 2
            rectangle: self.x, self.y, self.width, self.height
    drag_rectangle: self.x, self.y, self.width, self.height
    drag_timeout: 10000000
    drag_distance: 0
    orientation: "vertical"
    size_hint_x: 0.2
    Button:
        on_release: exec(root.code)
    TextInput:
        id: script_name_input
        hint_text: "script name"
    Button:
        id: add_button
        text: "+"
        on_release: root.add_block()


<BlockCodeArea@RelativeLayout>:
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            size: self.size
            # pos: self.pos
            source: "images/code_input.png"
    orientation: "vertical"
    BlockScript:


# <BlockCodeGenArea@RelativeLayout>:
#     height: 60
#     size_hint_y: None
#     canvas.before:
#         Color:
#             rgba: 1, 1, 1, 1
#         Rectangle:
#             size: self.size
#             source: "images/generate-block-area.png"


<WelcomeScreen>:
    canvas.before:
        Color:
            rgba: get_color_from_hex("#464646")
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        orientation: "vertical"
        padding: 10, 10
        spacing: 10
        ActionBar:
            height: 40
            size_hint_y: None
        BoxLayout:
            orientation: "vertical"
            padding: 148, 48, 148, 118
            spacing: 40
            Image:
                source: "images/logo.png"
                height: 32
                size_hint_y: None
            BoxLayout:
                orientation: "horizontal"
                spacing: 30
                IconButton:
                    icon: "images/open-file_icon.png"
                IconButton:
                    icon: "images/new-file_icon.png"
                    on_release: root.manager.current = "edit"
                IconButton:
                    icon: "images/explore_icon.png"
        ActionBar:
            height: 40
            size_hint_y: None


<EditScreen>:
    block_code_area: block_code_area
    canvas.before:
        Color:
            rgba: get_color_from_hex("#464646")
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        orientation: "vertical"
        padding: 10, 10
        spacing: 10
        ActionBar:
            height: 40
            size_hint_y: None
            ActionView:
                ActionPrevious:
                    app_icon: ""
                    on_release: root.manager.current = "welcome"
                    ActionButton:
                        icon: "images/open-file_icon.png"
                        width: 40
                    ActionButton:
                        icon: "images/save-file_icon.png"
                        width: 40
                    ActionButton:
                        icon: "images/new-file_icon.png"
                        width: 40
        BoxLayout:
            orientation: "vertical"
            BlockCodeArea:
                id: block_code_area
            # BlockCodeGenArea:
        BoxLayout:
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
                    source: "images/action_bar.png"
            orientation: "horizontal"
            height: 40
            size_hint_y: None
            Button:
                text: "Add script"
                on_release: root.add_script()
